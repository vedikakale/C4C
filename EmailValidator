import re

# List of suspicious phrases
suspicious_phrases = [
    "password",
    "credit card",
    "social security number",
    "click here",
    "verify your account",
    "update your information"
]

# List of commonly spoofed company names
spoofed_companies = [
    "Bank of America",
    "Paypal",
    "Amazon",
    "Apple",
    "Microsoft",
    "Google",
    "Facebook"
]

def check_grammar(email_text):
    # Basic check for grammar errors: Count number of non-alphanumeric characters excluding spaces
    non_alphanumeric_chars = len(re.findall(r'\W', email_text)) - len(re.findall(r'\s', email_text))
    return non_alphanumeric_chars

def check_suspicious_phrases(email_text):
    email_text = email_text.lower()
    for phrase in suspicious_phrases:
        if phrase in email_text:
            return True
    return False

def check_company_name(email_text):
    email_text = email_text.lower()
    for company in spoofed_companies:
        if company.lower() in email_text:
            return True
    return False

def validate_email(email_text):
    # Check grammar
    grammar_errors = check_grammar(email_text)
    grammar_score = " "
    if (grammar_errors >5):
        grammar_score = "High"
    else:
        grammar_score= "Low"
    

    # Check for suspicious phrases
    contains_suspicious_phrases = check_suspicious_phrases(email_text)
    suspicious_score = " "
    if contains_suspicious_phrases:
        suspicious_score= "High" 
    else:
        suspicious_score="Low"

    # Check company name
    valid_company = check_company_name(email_text)
    company_score = " "
    if valid_company:
        company_score= "Low" 
    else:
        company_score= "High"

    # Calculate overall phishing score
    phishing_score = 0
    if grammar_score == "High":
        phishing_score += 1
    if contains_suspicious_phrases:
        phishing_score += 1
    if company_score == "High":
        phishing_score += 1

    if phishing_score >= 2:
        return "High Phishing Attempt"
    elif phishing_score == 1:
        return "Potential Phishing Attempt"
    else:
        return "Low Phishing Attempt"

# Get email input from the user
email_text = input("Enter the email you received:\n")

# Validate the email
result = validate_email(email_text)
print(" ")
print(result)
